{"version":3,"file":"Zoom.stories-db81797d.js","sources":["../../ui/components/src/components/Zoom/ZoomElement.tsx","../../ui/components/src/components/Zoom/ZoomIFrame.tsx","../../ui/components/src/components/Zoom/Zoom.tsx"],"sourcesContent":["import type { ReactElement } from 'react';\nimport React, { useEffect, useRef, useState, useCallback } from 'react';\nimport useResizeObserver from 'use-resize-observer';\nimport { styled } from '@storybook/theming';\n\nconst ZoomElementWrapper = styled.div<{ scale: number; elementHeight: number }>(\n  ({ scale = 1, elementHeight }) => ({\n    height: elementHeight || 'auto',\n    transformOrigin: 'top left',\n    transform: `scale(${1 / scale})`,\n  })\n);\n\ntype ZoomProps = {\n  scale: number;\n  children: ReactElement | ReactElement[];\n};\n\nexport function ZoomElement({ scale, children }: ZoomProps) {\n  const componentWrapperRef = useRef<HTMLDivElement>(null);\n  const [elementHeight, setElementHeight] = useState(0);\n\n  const onResize = useCallback(\n    ({ height }) => {\n      if (height) {\n        setElementHeight(height / scale);\n      }\n    },\n    [scale]\n  );\n\n  useEffect(() => {\n    if (componentWrapperRef.current) {\n      setElementHeight(componentWrapperRef.current.getBoundingClientRect().height);\n    }\n  }, [scale]);\n\n  useResizeObserver({\n    ref: componentWrapperRef,\n    onResize,\n  });\n\n  return (\n    <ZoomElementWrapper scale={scale} elementHeight={elementHeight}>\n      <div ref={componentWrapperRef} className=\"innerZoomElementWrapper\">\n        {children}\n      </div>\n    </ZoomElementWrapper>\n  );\n}\n","import type { RefObject, ReactElement } from 'react';\nimport React, { Component } from 'react';\n\nexport type IZoomIFrameProps = {\n  scale: number;\n  children: ReactElement<HTMLIFrameElement>;\n  iFrameRef: RefObject<HTMLIFrameElement>;\n  active?: boolean;\n};\n\nexport class ZoomIFrame extends Component<IZoomIFrameProps> {\n  iframe: HTMLIFrameElement = null;\n\n  componentDidMount() {\n    const { iFrameRef } = this.props;\n    this.iframe = iFrameRef.current;\n  }\n\n  shouldComponentUpdate(nextProps: IZoomIFrameProps) {\n    const { scale, active } = this.props;\n\n    if (scale !== nextProps.scale) {\n      this.setIframeInnerZoom(nextProps.scale);\n    }\n\n    if (active !== nextProps.active) {\n      this.iframe.setAttribute('data-is-storybook', nextProps.active ? 'true' : 'false');\n    }\n\n    // this component renders an iframe, which gets updates via post-messages\n    // never update this component, it will cause the iframe to refresh\n    // the only exception is when the url changes, which happens when the version changes\n    return nextProps.children.props.src !== this.props.children.props.src;\n  }\n\n  setIframeInnerZoom(scale: number) {\n    try {\n      Object.assign(this.iframe.contentDocument.body.style, {\n        width: `${scale * 100}%`,\n        height: `${scale * 100}%`,\n        transform: `scale(${1 / scale})`,\n        transformOrigin: 'top left',\n      });\n    } catch (e) {\n      this.setIframeZoom(scale);\n    }\n  }\n\n  setIframeZoom(scale: number) {\n    Object.assign(this.iframe.style, {\n      width: `${scale * 100}%`,\n      height: `${scale * 100}%`,\n      transform: `scale(${1 / scale})`,\n      transformOrigin: 'top left',\n    });\n  }\n\n  render() {\n    const { children } = this.props;\n    return <>{children}</>;\n  }\n}\n","import { ZoomElement } from './ZoomElement';\nimport { ZoomIFrame } from './ZoomIFrame';\n\nexport const Zoom = {\n  Element: ZoomElement,\n  IFrame: ZoomIFrame,\n};\n"],"names":["ZoomElementWrapper","styled","scale","elementHeight","ZoomElement","children","componentWrapperRef","useRef","setElementHeight","useState","onResize","useCallback","height","useEffect","useResizeObserver","jsx","ZoomIFrame","Component","iFrameRef","nextProps","active","Fragment","Zoom"],"mappings":"gOAKA,MAAAA,EAAAC,EAAA,IAAkC,CAAA,CAAA,MAAAC,EAAA,EAAA,cAAAC,MAAA,CACG,OAAAA,GAAA,OACR,gBAAA,WACR,UAAA,SAAA,EAAAD,CAAA,GACY,EAEjC,EAOO,SAAAE,EAAA,CAAA,MAAAF,EAAA,SAAAG,GAAA,CACL,MAAAC,EAAAC,SAAA,IAAA,EACA,CAAAJ,EAAAK,CAAA,EAAAC,EAAA,SAAA,CAAA,EAEAC,EAAAC,EAAA,YAAiB,CAAA,CAAA,OAAAC,CAAA,IAAA,CAEbA,GACEJ,EAAAI,EAAAV,CAAA,CACF,EACF,CAAAA,CAAA,CACM,EAGRW,OAAAA,EAAAA,UAAA,IAAA,CACEP,EAAA,SACEE,EAAAF,EAAA,QAAA,sBAAA,EAAA,MAAA,CACF,EAAA,CAAAJ,CAAA,CAAA,EAGFY,EAAA,CAAkB,IAAAR,EACX,SAAAI,CACL,CAAA,EAGFK,EAAAf,EAAA,CAAA,MAAAE,EAAA,cAAAC,EAAA,SAAAY,EAAA,MAAA,CAAA,IAAAT,EAAA,UAAA,0BAAA,SAAAD,CAAA,CAAA,CAAA,CAAA,CAOF,iMCvCO,MAAAW,UAAAC,EAAAA,SAAA,CAAqD,aAAA,CAArD,MAAA,GAAA,SAAA,EACL,KAAA,OAAA,IAA4B,CAAA,mBAAA,CAG1B,KAAA,CAAA,UAAAC,CAAA,EAAA,KAAA,MACA,KAAA,OAAAA,EAAA,OAAwB,CAC1B,sBAAAC,EAAA,CAGE,KAAA,CAAA,MAAAjB,EAAA,OAAAkB,GAAA,KAAA,MAEA,OAAAlB,IAAAiB,EAAA,OACE,KAAA,mBAAAA,EAAA,KAAA,EAGFC,IAAAD,EAAA,QACE,KAAA,OAAA,aAAA,oBAAAA,EAAA,OAAA,OAAA,OAAA,EAMFA,EAAA,SAAA,MAAA,MAAA,KAAA,MAAA,SAAA,MAAA,GAAkE,CACpE,mBAAAjB,EAAA,CAGE,GAAA,CACE,OAAA,OAAA,KAAA,OAAA,gBAAA,KAAA,MAAA,CAAsD,MAAA,GAAAA,EAAA,GAAA,IAC/B,OAAA,GAAAA,EAAA,GAAA,IACC,UAAA,SAAA,EAAAA,CAAA,IACO,gBAAA,UACZ,CAAA,CAClB,MAAA,CAED,KAAA,cAAAA,CAAA,CAAwB,CAC1B,CACF,cAAAA,EAAA,CAGE,OAAA,OAAA,KAAA,OAAA,MAAA,CAAiC,MAAA,GAAAA,EAAA,GAAA,IACV,OAAA,GAAAA,EAAA,GAAA,IACC,UAAA,SAAA,EAAAA,CAAA,IACO,gBAAA,UACZ,CAAA,CAClB,CACH,QAAA,CAGE,KAAA,CAAA,SAAAG,CAAA,EAAA,KAAA,MACA,OAAAU,EAAAM,EAAA,CAAA,SAAAhB,CAAA,CAAA,CAAmB,CAEvB,8YC1DO,MAAMiB,EAAO,CAClB,QAASlB,EACT,OAAQY,CACV;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}