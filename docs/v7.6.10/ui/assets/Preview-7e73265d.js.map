{"version":3,"mappings":"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","names":["Zoom","zoom","resetZoom","jsxs","Fragment","jsx","IconButton","e","Icons","Bar","styled","FlexBar","Toolbar","isLoading","storyId","baseUrl","rest","Fragment2","key","IconButtonSkeleton","global","ChildrenContainer","isColumn","columns","layout","StyledSource","Source","theme","darken","PreviewContainer","withSource","isExpanded","getBlockBackgroundStyle","withToolbar","getSource","expanded","setExpanded","getStoryId","children","Children","elt","PositionedToolbar","Relative","Preview","additionalActions","className","props","useState","source","actionItem","scale","setScale","previewClasses","defaultActionItems","additionalActionItems","setAdditionalActionItems","actionItems","globalWindow","copyToClipboard","useCallback","text","createCopyToClipboardFunction","__vitePreload","n","onCopyCapture","selection","item","z","ZoomContext","child","i","ActionBar","StyledPreview","PreviewSkeleton","StorySkeleton"],"sources":["../../ui/blocks/src/components/Toolbar.tsx","../../ui/blocks/src/components/Preview.tsx"],"sourcesContent":["import type { FC, MouseEvent } from 'react';\nimport React, { Fragment } from 'react';\nimport { styled } from '@storybook/theming';\nimport { FlexBar, Icons, IconButton, IconButtonSkeleton } from '@storybook/components';\n\ninterface ZoomProps {\n  zoom: (val: number) => void;\n  resetZoom: () => void;\n}\n\ninterface EjectProps {\n  storyId?: string;\n  baseUrl?: string;\n}\n\ninterface BarProps {\n  border?: boolean;\n}\n\ninterface LoadingProps {\n  isLoading?: boolean;\n}\n\nexport type ToolbarProps = BarProps & ZoomProps & EjectProps & LoadingProps;\n\nconst Zoom: FC<ZoomProps> = ({ zoom, resetZoom }) => (\n  <>\n    <IconButton\n      key=\"zoomin\"\n      onClick={(e: MouseEvent<HTMLButtonElement>) => {\n        e.preventDefault();\n        zoom(0.8);\n      }}\n      title=\"Zoom in\"\n    >\n      <Icons icon=\"zoom\" />\n    </IconButton>\n    <IconButton\n      key=\"zoomout\"\n      onClick={(e: MouseEvent<HTMLButtonElement>) => {\n        e.preventDefault();\n        zoom(1.25);\n      }}\n      title=\"Zoom out\"\n    >\n      <Icons icon=\"zoomout\" />\n    </IconButton>\n    <IconButton\n      key=\"zoomreset\"\n      onClick={(e: MouseEvent<HTMLButtonElement>) => {\n        e.preventDefault();\n        resetZoom();\n      }}\n      title=\"Reset zoom\"\n    >\n      <Icons icon=\"zoomreset\" />\n    </IconButton>\n  </>\n);\n\nconst Bar = styled(FlexBar)({\n  position: 'absolute',\n  left: 0,\n  right: 0,\n  top: 0,\n  transition: 'transform .2s linear',\n});\n\nexport const Toolbar: FC<ToolbarProps> = ({\n  isLoading,\n  storyId,\n  baseUrl,\n  zoom,\n  resetZoom,\n  ...rest\n}) => (\n  <Bar {...rest}>\n    <Fragment key=\"left\">\n      {isLoading ? (\n        [1, 2, 3].map((key) => <IconButtonSkeleton key={key} />)\n      ) : (\n        <Zoom {...{ zoom, resetZoom }} />\n      )}\n    </Fragment>\n  </Bar>\n);\n","import type { ClipboardEvent, FC, ReactElement, ReactNode } from 'react';\nimport React, { Children, useCallback, useState } from 'react';\nimport { darken } from 'polished';\nimport { styled } from '@storybook/theming';\n\nimport { global } from '@storybook/global';\nimport { ActionBar, Zoom } from '@storybook/components';\nimport type { ActionItem } from '@storybook/components';\n\nimport type { SourceProps } from '.';\n// eslint-disable-next-line import/no-cycle\nimport { Source } from '.';\nimport { getBlockBackgroundStyle } from './BlockBackgroundStyles';\nimport { Toolbar } from './Toolbar';\nimport { ZoomContext } from './ZoomContext';\nimport { StorySkeleton } from './Story';\n\nexport interface PreviewProps {\n  isLoading?: true;\n  layout?: Layout;\n  isColumn?: boolean;\n  columns?: number;\n  withSource?: SourceProps;\n  isExpanded?: boolean;\n  withToolbar?: boolean;\n  className?: string;\n  additionalActions?: ActionItem[];\n  children?: ReactNode;\n}\n\nexport type Layout = 'padded' | 'fullscreen' | 'centered';\n\nconst ChildrenContainer = styled.div<PreviewProps & { layout: Layout }>(\n  ({ isColumn, columns, layout }) => ({\n    display: isColumn || !columns ? 'block' : 'flex',\n    position: 'relative',\n    flexWrap: 'wrap',\n    overflow: 'auto',\n    flexDirection: isColumn ? 'column' : 'row',\n\n    '& .innerZoomElementWrapper > *': isColumn\n      ? {\n          width: layout !== 'fullscreen' ? 'calc(100% - 20px)' : '100%',\n          display: 'block',\n        }\n      : {\n          maxWidth: layout !== 'fullscreen' ? 'calc(100% - 20px)' : '100%',\n          display: 'inline-block',\n        },\n  }),\n  ({ layout = 'padded' }) =>\n    layout === 'centered' || layout === 'padded'\n      ? {\n          padding: '30px 20px',\n          '& .innerZoomElementWrapper > *': {\n            width: 'auto',\n            border: '10px solid transparent!important',\n          },\n        }\n      : {},\n  ({ layout = 'padded' }) =>\n    layout === 'centered'\n      ? {\n          display: 'flex',\n          justifyContent: 'center',\n          justifyItems: 'center',\n          alignContent: 'center',\n          alignItems: 'center',\n        }\n      : {},\n  ({ columns }) =>\n    columns && columns > 1\n      ? { '.innerZoomElementWrapper > *': { minWidth: `calc(100% / ${columns} - 20px)` } }\n      : {}\n);\n\nconst StyledSource = styled(Source)(({ theme }) => ({\n  margin: 0,\n  borderTopLeftRadius: 0,\n  borderTopRightRadius: 0,\n  borderBottomLeftRadius: theme.appBorderRadius,\n  borderBottomRightRadius: theme.appBorderRadius,\n  border: 'none',\n\n  background:\n    theme.base === 'light' ? 'rgba(0, 0, 0, 0.85)' : darken(0.05, theme.background.content),\n  color: theme.color.lightest,\n  button: {\n    background:\n      theme.base === 'light' ? 'rgba(0, 0, 0, 0.85)' : darken(0.05, theme.background.content),\n  },\n}));\n\nconst PreviewContainer = styled.div<PreviewProps>(\n  ({ theme, withSource, isExpanded }) => ({\n    position: 'relative',\n    overflow: 'hidden',\n    margin: '25px 0 40px',\n    ...getBlockBackgroundStyle(theme),\n    borderBottomLeftRadius: withSource && isExpanded && 0,\n    borderBottomRightRadius: withSource && isExpanded && 0,\n    borderBottomWidth: isExpanded && 0,\n\n    'h3 + &': {\n      marginTop: '16px',\n    },\n  }),\n  ({ withToolbar }) => withToolbar && { paddingTop: 40 }\n);\n\ninterface SourceItem {\n  source?: ReactElement;\n  actionItem: ActionItem;\n}\n\nconst getSource = (\n  withSource: SourceProps,\n  expanded: boolean,\n  setExpanded: Function\n): SourceItem => {\n  switch (true) {\n    case !!(withSource && withSource.error): {\n      return {\n        source: null,\n        actionItem: {\n          title: 'No code available',\n          className: 'docblock-code-toggle docblock-code-toggle--disabled',\n          disabled: true,\n          onClick: () => setExpanded(false),\n        },\n      };\n    }\n    case expanded: {\n      return {\n        source: <StyledSource {...withSource} dark />,\n        actionItem: {\n          title: 'Hide code',\n          className: 'docblock-code-toggle docblock-code-toggle--expanded',\n          onClick: () => setExpanded(false),\n        },\n      };\n    }\n    default: {\n      return {\n        source: <StyledSource {...withSource} dark />,\n        actionItem: {\n          title: 'Show code',\n          className: 'docblock-code-toggle',\n          onClick: () => setExpanded(true),\n        },\n      };\n    }\n  }\n};\nfunction getStoryId(children: ReactNode) {\n  if (Children.count(children) === 1) {\n    const elt = children as ReactElement;\n    if (elt.props) {\n      return elt.props.id;\n    }\n  }\n  return null;\n}\n\nconst PositionedToolbar = styled(Toolbar)({\n  position: 'absolute',\n  top: 0,\n  left: 0,\n  right: 0,\n  height: 40,\n});\n\nconst Relative = styled.div({\n  overflow: 'hidden',\n  position: 'relative',\n});\n\n/**\n * A preview component for showing one or more component `Story`\n * items. The preview also shows the source for the component\n * as a drop-down.\n */\nexport const Preview: FC<PreviewProps> = ({\n  isLoading,\n  isColumn,\n  columns,\n  children,\n  withSource,\n  withToolbar = false,\n  isExpanded = false,\n  additionalActions,\n  className,\n  layout = 'padded',\n  ...props\n}) => {\n  const [expanded, setExpanded] = useState(isExpanded);\n  const { source, actionItem } = getSource(withSource, expanded, setExpanded);\n  const [scale, setScale] = useState(1);\n  const previewClasses = [className].concat(['sbdocs', 'sbdocs-preview', 'sb-unstyled']);\n\n  const defaultActionItems = withSource ? [actionItem] : [];\n  const [additionalActionItems, setAdditionalActionItems] = useState(\n    additionalActions ? [...additionalActions] : []\n  );\n  const actionItems = [...defaultActionItems, ...additionalActionItems];\n\n  const { window: globalWindow } = global;\n\n  const copyToClipboard = useCallback(async (text: string) => {\n    const { createCopyToClipboardFunction } = await import('@storybook/components');\n    createCopyToClipboardFunction();\n  }, []);\n\n  const onCopyCapture = (e: ClipboardEvent<HTMLInputElement>) => {\n    // When the selection range is neither empty nor collapsed, we can assume\n    // user's intention is to copy the selected text, instead of the story's\n    // code snippet.\n    const selection: Selection | null = globalWindow.getSelection();\n    if (selection && selection.type === 'Range') {\n      return;\n    }\n\n    e.preventDefault();\n    if (additionalActionItems.filter((item) => item.title === 'Copied').length === 0) {\n      copyToClipboard(source.props.code).then(() => {\n        setAdditionalActionItems([\n          ...additionalActionItems,\n          {\n            title: 'Copied',\n            onClick: () => {},\n          },\n        ]);\n        globalWindow.setTimeout(\n          () =>\n            setAdditionalActionItems(\n              additionalActionItems.filter((item) => item.title !== 'Copied')\n            ),\n          1500\n        );\n      });\n    }\n  };\n\n  return (\n    <PreviewContainer\n      {...{ withSource, withToolbar }}\n      {...props}\n      className={previewClasses.join(' ')}\n    >\n      {withToolbar && (\n        <PositionedToolbar\n          isLoading={isLoading}\n          border\n          zoom={(z: number) => setScale(scale * z)}\n          resetZoom={() => setScale(1)}\n          storyId={getStoryId(children)}\n          baseUrl=\"./iframe.html\"\n        />\n      )}\n      <ZoomContext.Provider value={{ scale }}>\n        <Relative className=\"docs-story\" onCopyCapture={withSource && onCopyCapture}>\n          <ChildrenContainer\n            isColumn={isColumn || !Array.isArray(children)}\n            columns={columns}\n            layout={layout}\n          >\n            <Zoom.Element scale={scale}>\n              {Array.isArray(children) ? (\n                // eslint-disable-next-line react/no-array-index-key\n                children.map((child, i) => <div key={i}>{child}</div>)\n              ) : (\n                <div>{children}</div>\n              )}\n            </Zoom.Element>\n          </ChildrenContainer>\n          <ActionBar actionItems={actionItems} />\n        </Relative>\n      </ZoomContext.Provider>\n      {withSource && expanded && source}\n    </PreviewContainer>\n  );\n};\n\nconst StyledPreview = styled(Preview)(() => ({\n  '.docs-story': {\n    paddingTop: 32,\n    paddingBottom: 40,\n  },\n}));\n\nexport const PreviewSkeleton = () => (\n  <StyledPreview isLoading withToolbar>\n    <StorySkeleton />\n  </StyledPreview>\n);\n"],"file":"assets/Preview-7e73265d.js"}