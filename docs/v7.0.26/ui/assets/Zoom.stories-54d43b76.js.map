{"version":3,"file":"Zoom.stories-54d43b76.js","sources":["../../ui/components/src/Zoom/browserSupportsCssZoom.ts","../../ui/components/src/Zoom/ZoomElement.tsx","../../ui/components/src/Zoom/ZoomIFrame.tsx","../../ui/components/src/Zoom/Zoom.tsx"],"sourcesContent":["export function browserSupportsCssZoom(): boolean {\n  try {\n    // First checks if Safari is being used, because Safari supports zoom, but it's buggy: https://developer.mozilla.org/en-US/docs/Web/CSS/zoom#browser_compatibility\n    if (/^((?!chrome|android).)*safari/i.test(navigator.userAgent)) {\n      return false;\n    }\n\n    // Next check if the browser supports zoom styling\n    return global.CSS?.supports('zoom: 1');\n  } catch (error) {\n    return false;\n  }\n}\n","import type { ReactElement } from 'react';\nimport React, { useEffect, useRef, useState, useCallback } from 'react';\nimport useResizeObserver from 'use-resize-observer';\nimport { styled } from '@storybook/theming';\nimport { browserSupportsCssZoom } from './browserSupportsCssZoom';\n\nconst hasBrowserSupportForCssZoom = browserSupportsCssZoom();\n\nconst ZoomElementWrapper = styled.div<{ scale: number; elementHeight: number }>(\n  ({ scale = 1, elementHeight }) =>\n    hasBrowserSupportForCssZoom\n      ? {\n          '> *': {\n            zoom: 1 / scale,\n          },\n        }\n      : {\n          height: elementHeight || 'auto',\n          transformOrigin: 'top left',\n          transform: `scale(${1 / scale})`,\n        }\n);\n\ntype ZoomProps = {\n  scale: number;\n  children: ReactElement | ReactElement[];\n};\n\nexport function ZoomElement({ scale, children }: ZoomProps) {\n  const componentWrapperRef = useRef<HTMLDivElement>(null);\n  const [elementHeight, setElementHeight] = useState(0);\n\n  const onResize = useCallback(\n    ({ height }) => {\n      if (height) {\n        setElementHeight(height / scale);\n      }\n    },\n    [scale]\n  );\n\n  useEffect(() => {\n    if (componentWrapperRef.current) {\n      setElementHeight(componentWrapperRef.current.getBoundingClientRect().height);\n    }\n  }, [scale]);\n\n  useResizeObserver({\n    ref: componentWrapperRef,\n    onResize,\n  });\n\n  return (\n    <ZoomElementWrapper scale={scale} elementHeight={elementHeight}>\n      <div\n        ref={hasBrowserSupportForCssZoom ? null : componentWrapperRef}\n        className=\"innerZoomElementWrapper\"\n      >\n        {children}\n      </div>\n    </ZoomElementWrapper>\n  );\n}\n","import type { RefObject, ReactElement } from 'react';\nimport { Component } from 'react';\nimport { browserSupportsCssZoom } from './browserSupportsCssZoom';\n\nexport type IZoomIFrameProps = {\n  scale: number;\n  children: ReactElement<HTMLIFrameElement>;\n  iFrameRef: RefObject<HTMLIFrameElement>;\n  active?: boolean;\n};\n\nexport class ZoomIFrame extends Component<IZoomIFrameProps> {\n  iframe: HTMLIFrameElement = null;\n\n  componentDidMount() {\n    const { iFrameRef } = this.props;\n    this.iframe = iFrameRef.current;\n  }\n\n  shouldComponentUpdate(nextProps: IZoomIFrameProps) {\n    const { scale, active } = this.props;\n\n    if (scale !== nextProps.scale) {\n      this.setIframeInnerZoom(nextProps.scale);\n    }\n\n    if (active !== nextProps.active) {\n      this.iframe.setAttribute('data-is-storybook', nextProps.active ? 'true' : 'false');\n    }\n\n    // this component renders an iframe, which gets updates via post-messages\n    // never update this component, it will cause the iframe to refresh\n    // the only exception is when the url changes, which happens when the version changes\n    return nextProps.children.props.src !== this.props.children.props.src;\n  }\n\n  setIframeInnerZoom(scale: number) {\n    try {\n      if (browserSupportsCssZoom()) {\n        Object.assign(this.iframe.contentDocument.body.style, {\n          zoom: 1 / scale,\n          minHeight: `calc(100vh / ${1 / scale})`,\n        });\n      } else {\n        Object.assign(this.iframe.contentDocument.body.style, {\n          width: `${scale * 100}%`,\n          height: `${scale * 100}%`,\n          transform: `scale(${1 / scale})`,\n          transformOrigin: 'top left',\n        });\n      }\n    } catch (e) {\n      this.setIframeZoom(scale);\n    }\n  }\n\n  setIframeZoom(scale: number) {\n    Object.assign(this.iframe.style, {\n      width: `${scale * 100}%`,\n      height: `${scale * 100}%`,\n      transform: `scale(${1 / scale})`,\n      transformOrigin: 'top left',\n    });\n  }\n\n  render() {\n    const { children } = this.props;\n    return children;\n  }\n}\n","import { ZoomElement } from './ZoomElement';\nimport { ZoomIFrame } from './ZoomIFrame';\n\nexport const Zoom = {\n  Element: ZoomElement,\n  IFrame: ZoomIFrame,\n};\n"],"names":["browserSupportsCssZoom","_a","hasBrowserSupportForCssZoom","ZoomElementWrapper","styled","scale","elementHeight","ZoomElement","children","componentWrapperRef","useRef","setElementHeight","useState","onResize","useCallback","height","useEffect","useResizeObserver","jsx","ZoomIFrame","Component","iFrameRef","nextProps","active","Zoom"],"mappings":"qPAAO,SAASA,GAAkC,OAC5C,GAAA,CAEF,MAAI,iCAAiC,KAAK,UAAU,SAAS,EACpD,IAIFC,EAAA,OAAO,MAAP,YAAAA,EAAY,SAAS,iBAErB,MAAA,EACT,CACF,CCNA,MAAAC,EAAAF,EAAA,EAEAG,EAAAC,EAAA,IAAkC,CAAA,CAAA,MAAAC,EAAA,EAAA,cAAAC,CAAA,IAAAJ,EAAA,CAG1B,MAAA,CACS,KAAA,EAAAG,CACK,CACZ,EAAA,CAEF,OAAAC,GAAA,OAC2B,gBAAA,WACR,UAAA,SAAA,EAAAD,IACO,CAElC,EAOO,SAAAE,EAAA,CAAA,MAAAF,EAAA,SAAAG,GAAA,CACL,MAAAC,EAAAC,SAAA,IAAA,EACA,CAAAJ,EAAAK,CAAA,EAAAC,EAAA,SAAA,CAAA,EAEAC,EAAAC,EAAA,YAAiB,CAAA,CAAA,OAAAC,CAAA,IAAA,CAEbA,GACEJ,EAAAI,EAAAV,CAAA,CACF,EACF,CAAAA,CAAA,CACM,EAGRW,OAAAA,EAAAA,UAAA,IAAA,CACEP,EAAA,SACEE,EAAAF,EAAA,QAAA,sBAAA,EAAA,MAAA,CACF,EAAA,CAAAJ,CAAA,CAAA,EAGFY,EAAA,CAAkB,IAAAR,EACX,SAAAI,CACL,CAAA,EAGFK,EAAAf,EAAA,CAAA,MAAAE,EAAA,cAAAC,EAAA,SAAAY,EAEI,MAAC,CAAA,IAAAhB,EAAA,KAAAO,EAC2C,UAAA,0BAChC,SAAAD,CAET,CAAA,CAAA,CAAA,CAIT,iMCnDO,MAAAW,UAAAC,EAAAA,SAAA,CAAqD,aAAA,CAArD,MAAA,GAAA,SAAA,EACL,KAAA,OAAA,IAA4B,CAAA,mBAAA,CAG1B,KAAA,CAAA,UAAAC,CAAA,EAAA,KAAA,MACA,KAAA,OAAAA,EAAA,OAAwB,CAC1B,sBAAAC,EAAA,CAGE,KAAA,CAAA,MAAAjB,EAAA,OAAAkB,GAAA,KAAA,MAEA,OAAAlB,IAAAiB,EAAA,OACE,KAAA,mBAAAA,EAAA,KAAA,EAGFC,IAAAD,EAAA,QACE,KAAA,OAAA,aAAA,oBAAAA,EAAA,OAAA,OAAA,OAAA,EAMFA,EAAA,SAAA,MAAA,MAAA,KAAA,MAAA,SAAA,MAAA,GAAkE,CACpE,mBAAAjB,EAAA,CAGE,GAAA,CACEL,EAAA,EACE,OAAA,OAAA,KAAA,OAAA,gBAAA,KAAA,MAAA,CAAsD,KAAA,EAAAK,EAC1C,UAAA,gBAAA,EAAAA,IACqB,CAAA,EAGjC,OAAA,OAAA,KAAA,OAAA,gBAAA,KAAA,MAAA,CAAsD,MAAA,GAAAA,EAAA,OAClC,OAAA,GAAAA,EAAA,OACC,UAAA,SAAA,EAAAA,KACK,gBAAA,UACP,CAAA,CAErB,MAAA,CAEA,KAAA,cAAAA,CAAA,CAAwB,CAC1B,CACF,cAAAA,EAAA,CAGE,OAAA,OAAA,KAAA,OAAA,MAAA,CAAiC,MAAA,GAAAA,EAAA,OACb,OAAA,GAAAA,EAAA,OACC,UAAA,SAAA,EAAAA,KACK,gBAAA,UACP,CAAA,CAClB,CACH,QAAA,CAGE,KAAA,CAAA,SAAAG,CAAA,EAAA,KAAA,MACA,OAAAA,CAAO,CAEX,8YClEO,MAAMgB,EAAO,CAClB,QAASjB,EACT,OAAQY,CACV;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}