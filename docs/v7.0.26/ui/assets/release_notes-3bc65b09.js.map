{"version":3,"file":"release_notes-3bc65b09.js","sources":["../../ui/manager/src/settings/release_notes.tsx"],"sourcesContent":["import type { FC, ComponentProps } from 'react';\nimport React, { useEffect, useState, Fragment } from 'react';\nimport { styled } from '@storybook/theming';\nimport { Icons, Loader } from '@storybook/components';\n\nconst Centered = styled.div({\n  top: '50%',\n  position: 'absolute',\n  transform: 'translateY(-50%)',\n  width: '100%',\n  textAlign: 'center',\n});\n\nconst LoaderWrapper = styled.div({\n  position: 'relative',\n  height: '32px',\n});\n\nconst Message = styled.div(({ theme }) => ({\n  paddingTop: '12px',\n  color: theme.textMutedColor,\n  maxWidth: '295px',\n  margin: '0 auto',\n  fontSize: `${theme.typography.size.s1}px`,\n  lineHeight: `16px`,\n}));\n\nconst Iframe = styled.iframe<{ isLoaded: boolean }>(\n  {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    border: 0,\n    margin: 0,\n    padding: 0,\n    width: '100%',\n    height: '100%',\n  },\n  ({ isLoaded }) => ({ visibility: isLoaded ? 'visible' : 'hidden' })\n);\n\nconst AlertIcon = styled(((props) => <Icons icon=\"alert\" {...props} />) as FC<\n  Omit<ComponentProps<typeof Icons>, 'icon'>\n>)(({ theme }) => ({\n  color: theme.textMutedColor,\n  width: 32,\n  height: 32,\n  margin: '0 auto',\n}));\n\nconst getIframeUrl = (version: string) => {\n  const [major, minor] = version.split('.');\n  return `https://storybook.js.org/releases/iframe/${major}.${minor}`;\n};\n\nconst ReleaseNotesLoader: FC = () => (\n  <Centered>\n    <LoaderWrapper>\n      <Loader />\n    </LoaderWrapper>\n    <Message>Loading release notes</Message>\n  </Centered>\n);\n\nconst MaxWaitTimeMessaging: FC = () => (\n  <Centered>\n    <AlertIcon />\n    <Message>\n      The release notes couldn't be loaded. Check your internet connection and try again.\n    </Message>\n  </Centered>\n);\n\nexport interface ReleaseNotesProps {\n  didHitMaxWaitTime: boolean;\n  isLoaded: boolean;\n  setLoaded: (isLoaded: boolean) => void;\n  version: string;\n}\n\nconst PureReleaseNotesScreen: FC<ReleaseNotesProps> = ({\n  didHitMaxWaitTime,\n  isLoaded,\n  setLoaded,\n  version,\n}) => (\n  <Fragment>\n    {!isLoaded && !didHitMaxWaitTime && <ReleaseNotesLoader />}\n    {didHitMaxWaitTime ? (\n      <MaxWaitTimeMessaging />\n    ) : (\n      <Iframe\n        isLoaded={isLoaded}\n        onLoad={() => setLoaded(true)}\n        src={getIframeUrl(version)}\n        title={`Release notes for Storybook version ${version}`}\n      />\n    )}\n  </Fragment>\n);\n\nconst MAX_WAIT_TIME = 10000; // 10 seconds\n\nconst ReleaseNotesScreen: FC<\n  Omit<ReleaseNotesProps, 'isLoaded' | 'setLoaded' | 'didHitMaxWaitTime'>\n> = ({ version }) => {\n  const [isLoaded, setLoaded] = useState(false);\n  const [didHitMaxWaitTime, setDidHitMaxWaitTime] = useState(false);\n\n  useEffect(() => {\n    const timer = setTimeout(() => !isLoaded && setDidHitMaxWaitTime(true), MAX_WAIT_TIME);\n    return () => clearTimeout(timer);\n  }, [isLoaded]);\n\n  return (\n    <PureReleaseNotesScreen\n      didHitMaxWaitTime={didHitMaxWaitTime}\n      isLoaded={isLoaded}\n      setLoaded={setLoaded}\n      version={version}\n    />\n  );\n};\n\nexport { ReleaseNotesScreen, PureReleaseNotesScreen };\n"],"names":["Centered","styled","LoaderWrapper","Message","theme","Iframe","isLoaded","AlertIcon","props","jsx","Icons","getIframeUrl","version","major","minor","ReleaseNotesLoader","jsxs","Loader","MaxWaitTimeMessaging","PureReleaseNotesScreen","didHitMaxWaitTime","setLoaded","Fragment","MAX_WAIT_TIME","ReleaseNotesScreen","useState","setDidHitMaxWaitTime","useEffect","timer"],"mappings":"oLAKA,MAAAA,EAAAC,EAAA,IAAA,CAA4B,IAAA,MACrB,SAAA,WACK,UAAA,mBACC,MAAA,OACJ,UAAA,QAET,CAAA,EAEAC,EAAAD,EAAA,IAAA,CAAiC,SAAA,WACrB,OAAA,MAEZ,CAAA,EAEAE,EAAAF,EAAA,IAAA,CAAA,CAAA,MAAAG,CAAA,KAAA,CAA2C,WAAA,OAC7B,MAAAA,EAAA,eACC,SAAA,QACH,OAAA,SACF,SAAA,GAAAA,EAAA,WAAA,KAAA,OAC2B,WAAA,MAErC,EAAA,EAEAC,EAAAJ,EAAA,OAAsB,CACpB,SAAA,WACY,IAAA,EACL,KAAA,EACC,MAAA,EACC,OAAA,EACC,OAAA,EACA,OAAA,EACA,QAAA,EACC,MAAA,OACF,OAAA,MACC,EACV,CAAA,CAAA,SAAAK,CAAA,KAAA,CAAA,WAAAA,EAAA,UAAA,UAEF,EAEAC,EAAAN,EAAAO,GAAAC,EAAAC,EAAA,CAAA,KAAA,QAAA,GAAAF,CAAA,CAAA,CAAA,EAAA,CAAA,CAAA,MAAAJ,CAAA,KAAA,CAEmB,MAAAA,EAAA,eACJ,MAAA,GACN,OAAA,GACC,OAAA,QAEV,EAAA,EAEAO,EAAAC,GAAA,CACE,KAAA,CAAAC,EAAAC,CAAA,EAAAF,EAAA,MAAA,GAAA,EACA,MAAA,4CAAAC,KAAAC,GACF,EAEAC,EAAA,IAAAC,EAAAhB,EAAA,CAAA,SAAA,CAEIS,EAAAP,EAAA,CAAA,SAAAO,EAAAQ,EAAA,CAAA,CAAA,EAAA,EAEAR,EAAAN,EAAA,CAAA,SAAA,uBAAA,CAAA,CAC8B,CAAA,CAAA,EAIlCe,EAAA,IAAAF,EAAAhB,EAAA,CAAA,SAAA,CAEIS,EAAAF,EAAA,EAAA,EAAWE,EAAAN,EAAA,CAAA,SAAA,qFAAA,CAAA,CAGX,CAAA,CAAA,EAWJgB,EAAA,CAAA,CAAuD,kBAAAC,EACrD,SAAAd,EACA,UAAAe,EACA,QAAAT,CAEF,IAAAI,EAAAM,WAAA,CAAA,SAAA,CAEK,CAAAhB,GAAA,CAAAc,GAAAX,EAAAM,EAAA,CAAA,CAAA,EAAuDK,EAAAX,EAAAS,EAAA,CAAA,CAAA,EAAAT,EAItDJ,EAAC,CAAA,SAAAC,EACC,OAAA,IAAAe,EAAA,EAAA,EAC4B,IAAAV,EAAAC,CAAA,EACH,MAAA,uCAAAA,GACqB,CAAA,CAChD,EAAA,EAKNW,EAAA,IAEAC,EAAA,CAAA,CAAA,QAAAZ,KAAA,CAGE,KAAA,CAAAN,EAAAe,CAAA,EAAAI,EAAA,SAAA,EAAA,EACA,CAAAL,EAAAM,CAAA,EAAAD,EAAA,SAAA,EAAA,EAEAE,OAAAA,EAAAA,UAAA,IAAA,CACE,MAAAC,EAAA,WAAA,IAAA,CAAAtB,GAAAoB,EAAA,EAAA,EAAAH,CAAA,EACA,MAAA,IAAA,aAAAK,CAAA,CAA+B,EAAA,CAAAtB,CAAA,CAAA,EAGjCG,EACEU,EAAC,CAAA,kBAAAC,EACC,SAAAd,EACA,UAAAe,EACA,QAAAT,CACA,CAAA,CAGN"}